require("regenerator-runtime/runtime"),require("core-js/stable");var e,t=(e=require("sweetalert2"))&&e.__esModule?e.default:e;class n{containerApp=document.querySelector(".app");containerMovements=document.querySelector(".movements");btnLogin=document.querySelector(".login__btn");btnTransfer=document.querySelector(".form__btn--transfer");btnLoan=document.querySelector(".form__btn--loan");btnClose=document.querySelector(".form__btn--close");btnSort=document.querySelector(".btn--sort");btnLoginOpenModal=document.querySelector(".open_login-modal");btnSignupOpenModal=document.querySelector(".open_signup-modal");btnLogOut=document.querySelector(".logout");inputLoginUsername=document.querySelector(".login__input--user");inputLoginPin=document.querySelector(".login__input--pin");inputTransferTo=document.querySelector(".form__input--to");inputTransferAmount=document.querySelector(".form__input--amount");inputLoanAmount=document.querySelector(".form__input--loan-amount");inputCloseUsername=document.querySelector(".form__input--user");inputClosePin=document.querySelector(".form__input--pin");labelWelcome=document.querySelector(".welcome");labelBVN=document.querySelector(".bvn_label");labelACC=document.querySelector(".acc_label");labelAccType=document.querySelector(".acc-type_label");labelBalance=document.querySelector(".balance__value");labelSumIn=document.querySelector(".summary__value--in");labelSumOut=document.querySelector(".summary__value--out");labelSumInterest=document.querySelector(".summary__value--interest");labelTimer=document.querySelector(".timer");labelDate=document.querySelector(".date");loginModal=document.querySelector(".login_modal");signupModal=document.querySelector(".signup_modal");overlay=document.querySelector(".overlay");loginCloseModal=document.querySelector(".login_btn--close-modal");signupCloseModal=document.querySelector(".signup_btn--close-modal");btnLoginOpenModal=document.querySelector(".open_login-modal");btnSignupOpenModal=document.querySelector(".open_signup-modal");btnRegister=document.querySelector(".register_button");fullNameField=document.querySelector(".fullname");mobileField=document.querySelector(".mobile");userNameField=document.querySelector(".user_name");amountField=document.querySelector(".amount");passwordField=document.querySelector(".password");bvnField=document.querySelector(".bvn");accountTypeField=document.querySelector("#account_type");idTypeField=document.querySelector(".id_type");idNumberField=document.querySelector(".id_number");labelBVN=document.querySelector(".bvn_labell");idTypeSpan=document.querySelector(".id_type-span");idNumberSpan=document.querySelector(".id_number-span")}const l=new n;class o{constructor(){this.calcDate()}_calcInterest(){let e=Date.now();return Number(e.toString().split("").slice(11,14).join(""))/10}_generateBVN(){let e=Date.now();return Number(e.toString().split("").slice(3,14).join(""))}_generateAccountNumber(){return this._generateBVN()-1111e6}timeStamp(){const e=Date.now();let t=new Date(e);const n=t.getMonth()+1,l=t.getDate(),o=t.getFullYear();let r;r=12===t.getHours()?t.getHours()+1:t.getHours()>12?t.getHours()-12:t.getHours();const a=t.getMinutes();let i;return i=String(t.getSeconds()).length>1?t.getSeconds():`0${t.getSeconds()}`,`${l}/${n}/${o}      ${r}:${a}:${i}`}checkMinimumAmount(e,n,o){n!==e||Number(l.amountField.value)===o||t.fire({title:"Error",text:`Minimum amount for Tier ${n} is ${o}`,icon:"error"})}suggestBVN(){l.bvnField.addEventListener("focus",(e=>{e.target.value=this._generateBVN()}))}setAccountType(){l.accountTypeField.addEventListener("change",(function(e){let t=e.target.value;"Tier One"===t?(l.bvnField.value="",l.bvnField.style.display="none",l.labelBVN.style.display="none"):(l.bvnField.style.display="block",l.labelBVN.style.display="block"),"Tier Three"===t?(l.idTypeSpan.classList.remove("display_none"),l.idNumberSpan.classList.remove("display_none")):(l.idTypeSpan.classList.add("display_none"),l.idNumberSpan.classList.add("display_none"))}))}setTier3ID(e,t,n){"Tier Three"===e&&(l.idTypeField.value,l.idNumberField.value)}clearInputFields(){l.fullNameField.value=l.mobileField.value=l.userNameField.value=l.amountField.value=l.passwordField.value=l.bvnField.value=""}calcDate(){const e=new Date;let t=`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`;l.labelDate.textContent=t}generateOTP(){let e=Date.now();return e=String(e).split("").slice(8,13).join(""),e}}class r{currentUser;alluser=JSON.parse(localStorage.getItem("UserData"))||[];saveUser(e){this.alluser.push(e),localStorage.setItem("UserData",JSON.stringify(this.alluser))}saveAllUsers(e){localStorage.setItem("UserData",JSON.stringify(e))}getAllUsers(){return JSON.parse(localStorage.getItem("UserData"))||[]}getCurrentUser(e,t){return this.currentUser=e.find((e=>e.userName===t)),this.currentUser}}class a extends class{constructor(e,t,n){this.accNumber=e,this.accBalance=t,this.movementsDate=n}}{constructor(e,t,n,l,o,r,a){super(e,t,n),this.accType=l,this.accInterest=o,this.minAmount=r,this.maxAmount=a,this.mov=[t]}}class i extends a{constructor(e,t,n,l,o,r,a,i,s){super(e,t,n,l,o,r,a),this.idenType=i,this.idenNumber=s}}const s=new n;class u{constructor(e,t){this.btnSignupOpenModal=e,this.btnLoginOpenModal=t,this._openModal(this.btnLoginOpenModal,s.loginModal),this._openModal(this.btnSignupOpenModal,s.signupModal),this._closeModal(s.loginCloseModal,s.loginModal),this._closeModal(s.signupCloseModal,s.signupModal)}showModal(e=s.loginModal){e.classList.remove("hidden"),s.overlay.classList.remove("hidden")}_openModal(e=s.btnLoginOpenModal,t){e.addEventListener("click",(()=>{this.showModal(t)}))}hideModal(e=s.loginModal){e.classList.add("hidden"),s.overlay.classList.add("hidden")}_closeModal(e,t){e.addEventListener("click",(()=>{this.hideModal(t)})),s.overlay.addEventListener("click",(()=>{this.hideModal(t)}))}}let c=new r;const d=new o,m=new n;let p=c.getAllUsers();const g=new u(m.btnSignupOpenModal,m.btnLoginOpenModal);let b,v="Tier One",y="Tier Two",h="Tier Three";function S(e){let n;e.preventDefault();let l,o,r,a,i,s=m.fullNameField.value,u=m.mobileField.value,S=m.userNameField.value,f=Number(m.amountField.value),_=m.passwordField.value,T=d._generateAccountNumber(),L=[d.timeStamp()],M=d._calcInterest();const N=""!==s&&""!==u&&""!==S&&""!==f&&""!==_;l=b===v?void 0:m.bvnField.value,"Tier Three"===b&&(o=m.idTypeField.value,r=m.idNumberField.value),b===v&&(i=5e5,a=1e3),b===y&&(i=2e6,a=5e3),b===h&&(i=5e6,a=2e4);p.length>0&&(n=p.map((e=>e.userName)).some((e=>e===m.userNameField.value))),n?t.fire({title:"Error",text:"Username Alredy exist!",icon:"error"}):0===p.length&&N||N?(()=>{let e=Number(m.amountField.value)>=1e3&&Number(m.amountField.value)<=5e5;if("Tier One"===b&&!e)return void t.fire({title:"Error",text:"Amount for Tier One is between 1,000 - 500,000",icon:"error"});let n=Number(m.amountField.value)>=5e3&&Number(m.amountField.value)<=2e6;if("Tier Two"===b&&!n)return void t.fire({title:"Error",text:"Amount for Tier Two is between 5,000 - 2,000,000",icon:"error"});let p=Number(m.amountField.value)>=2e4&&Number(m.amountField.value)<=5e6;if("Tier Three"===b&&!p)return void t.fire({title:"Error",text:"Amount for Tier Three is between 20,000 - 5,000,000",icon:"error"});const v=new B(s,S,_,u,l);v.createAcc(T,f,L,b,M,a,i,o,r),c.saveUser(v),d.clearInputFields(),g.hideModal(m.signupModal),t.fire({title:"Success",text:"Registration Successful, Kindly Login",icon:"success"}).then((e=>{e&&location.reload()}))})():t.fire({title:"Error",text:"All fields are require",icon:"error"})}m.accountTypeField.addEventListener("change",(e=>b=e.target.value));let f=new n,_=new u(f.btnSignupOpenModal,f.btnLoginOpenModal);class T{disPlayLogoutBtn(){f.btnLoginOpenModal.classList.add("hidden"),f.btnSignupOpenModal.classList.add("hidden"),f.btnLogOut.classList.remove("hidden")}logUserInfo(e){f.containerApp.style.opacity=1,f.labelWelcome.textContent=`Welcome here ${e.userFullName}`,f.labelWelcome.classList.add("highlight");let t=e.acc.map((e=>e.accNumber));f.labelACC.textContent=` ACC: ${t[0]}`,f.labelACC.classList.remove("hidden"),f.labelACC.style.paddingLeft="15px";let n=e.acc.map((e=>e.accType));f.labelAccType.textContent=`Type: ${n[0]}`,f.labelAccType.classList.remove("hidden"),f.labelAccType.style.paddingLeft="10px",f.inputLoginUsername.value="",f.inputLoginPin.value="",f.inputLoginPin.blur,_.hideModal(),this.disPlayLogoutBtn()}appendMovement(e,t=!1){f.containerMovements.innerHTML="";let n=e.acc.map((e=>e.mov)),l=e.acc.map((e=>e.movementsDate));let o;(t?n[0].sort(((e,t)=>t-e)):n[0]).map(((e,t)=>{const n=e>0?"credit":"debit";let r=l[0][t];o=document.createElement("div"),o.classList.add("movements__row");const a=document.createElement("div");a.classList.add("movements__type",`movements__type--${n}`),a.textContent=`${t+1} ${n}`;let i=document.createElement("div");i.classList.add("movements__date"),i.textContent=`${r}`;const s=document.createElement("div");s.classList.add("movements__value"),s.textContent=`${e}€`,o.appendChild(a),o.appendChild(i),o.appendChild(s),f.containerMovements.insertAdjacentElement("afterbegin",o)}))}balance(e){let t=e.acc.map((e=>e.mov));t[0].accBalance=t[0].reduce(((e,t)=>e+t),0),f.labelBalance.textContent=`${t[0].accBalance}€`}calcSumary(e){let t=e.acc.map((e=>e.mov)),n=e.acc.map((e=>e.accInterest));const l=t.filter((e=>e>0)).reduce(((e,t)=>e+t),0);f.labelSumIn.textContent=`${l}€`;const o=t.filter((e=>e<0)).reduce(((e,t)=>e+t),0);f.labelSumOut.textContent=`${Math.abs(o)}€`;const r=t.filter((e=>e>0)).map((e=>e*n[0]/100)).filter((e=>e>=1)).reduce(((e,t)=>e+t),0);f.labelSumInterest.textContent=`${r.toFixed(1)}€`}updateUI(e){this.appendMovement(e),this.balance(e),this.calcSumary(e)}calcDate(){const e=new Date;let t=`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`;labelDate.textContent=t}toast(e,n){t.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",t.stopTimer),e.addEventListener("mouseleave",t.resumeTimer)}}).fire({icon:e,title:n})}}const L=new n,M=new T,N=new r;const q=new n,F=new o,w=new T,O=new r;const A=new n;function C(){A.containerApp.style.opacity=0,A.btnLogOut.classList.add("hidden"),A.btnLoginOpenModal.classList.remove("hidden"),A.btnSignupOpenModal.classList.remove("hidden"),location.reload()}const x=new n;let D=new r;const U=new o;let $,E=D.getAllUsers();class B{constructor(e,t,n,l,o){this.userFullName=e,this.userName=t,this.userPin=n,this.userMobile=l,this.userBVN=o,this.acc=[],this.register(),this.userLogin(),this.makeTransfer(),this.logOut()}register(){U.suggestBVN(),U.setAccountType(),x.btnRegister.addEventListener("click",S)}createAcc(e,t,n,l,o,r,s,u,c){let d;d="Tier Three"===l?new i(e,t,n,l,o,r,s,u,c):new a(e,t,n,l,o,r,s),this.acc.push(d)}userLogin(){x.btnLogin.addEventListener("click",(e=>{e.preventDefault(),$=function(e,n){let l=N.getCurrentUser(E,L.inputLoginUsername.value);return l?.userPin===n&&l?.userName==e?(M.logUserInfo(l),M.disPlayLogoutBtn(),M.updateUI(l)):t.fire("Warning","Wrong Log in details","error"),N.saveAllUsers(E),l}(x.inputLoginUsername.value,x.inputLoginPin.value)}))}makeTransfer(){x.btnTransfer.addEventListener("click",(e=>{e.preventDefault(),function(e,n){let l=F.generateOTP(),o=E.map((e=>e.acc)).flat().find((e=>e.accNumber===n));console.log(o);let r=$.acc.find((e=>e.mov));if(r.accBalance>=e&&n&&n!==String(r.accNumber)&&e>0&&o){const n=o?.mov?.reduce?.(((e,t)=>e+t),0);E.forEach((a=>{a.userFullName===$.userFullName&&(("Tier One"===o.accType&&n+e<=1e5||"Tier Two"===o.accType&&n+e<=1e6||"Tier Three"===o.accType&&n+e<=5e6)&&l?t.fire({title:"supply OTP",text:`input this OTP code (${l}) to conplete this transaction`,icon:"info",input:"text"}).then((t=>{if(t.isConfirmed&&t.value===l){const t=F.timeStamp();r.movementsDate.push(t),o.movementsDate.push(t),r.mov.push(-e),o.mov.push(e),O.saveAllUsers(E),console.log(E),console.log(r),w.updateUI($),q.inputTransferAmount.value="",q.inputTransferTo.value="",e.blur,w.toast("success","Transfer Successful")}else w.toast("error","Wrong OTP")})):t.fire({title:"Warning",text:"Maximum amount for the receiver exceeded",icon:"error"}))}))}else t.fire("Warning","Wrong Receiver info.","error")}(Number(x.inputTransferAmount.value),Number(x.inputTransferTo.value))}))}logOut(){x.btnLogOut.addEventListener("click",C)}}new B;
//# sourceMappingURL=newScript.js.map
